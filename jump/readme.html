<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html" />
    <title>SFMT jump function</title>
    <style type="text/css">
      BODY {margin-left: 1%}
      BLOCKQUOTE {background-color:#e0ffe0;
                  padding-left: 1em;}
      div.math {padding-left:2em;
                font-weight:bold}
    </style>
  </head>
  <body>
    <h2>Index</h2>
    <ul>
      <li><a href="#jump">About dSFMT jump function</a></li>
      <ul>
	<li><a href="#calculation">
	    Step 1: Calculations of jump polynomial</a></li>
	<li><a href="#execution">
	    Step 2: Changing internal state of dSFMT to jumped state.</a></li>
      </ul>
      <li><a href="#compile">Install, Compile and Test</a></li>
      <li><a href="#sample">Samples of Parallel generation</a></li>
      <li><a href="#license">License</a></li>
    </ul>

    <h2><a id="jump">About dSFMT jump function</a></h2>
    <p>
      For a given integer N, this jump function executes the N-step
      jump. Namely, from the given state, obtain the state of dSFMT
      after N steps generation. This is equivalent to call the dSFMT
      double precision floating point number generation 2N times
      with discarding the
      outputs. A typical usage of a jump function is to obtain
      distinct sub streams from a whole period of pseudorandom number
      sequence generated by one dSFMT.
    </p>
    <p>
      There are two steps for doing jump. Calculations of jump polynomial
      and changing internal state.
    </p>

    <h3><a id="calculation">Step 1: Calculations of jump polynomial</a></h3>

    <p>To calculate jump polynomial, we use pre-calculated polynomials for
      MEXPs, we omit explanation of the polynomial.
      The pre-calculated polynomials are stored in
      'poly.{MEXP}.txt files.<br/>
      The executable binary file 'calc-jump' calculates jump polynomial
      from command line. Here is a usage:
      <blockquote>
	<pre>
./calc-jump jump-step polynomial-file
    jump-step: a number between zero and 2^{DSFMT_MEXP}-1.
               large decimal number is allowed.
    polynomial-file: one of poly.{DSFMT_MEXP}.txt file
</pre>
      </blockquote>
    <p>
      Users can call C++ function 'dsfmt::calc_jump' in C++ header file
      'dSFMT-calc-jump.hpp' to calculate jump polynomials.
    </p>
    <p><a href="http://shoup.net/ntl/">NTL: A Library for doing Number
    Theory</a> by Victor Shoup is used for polynomial calculation and
    handling large integers.
    </p>
    <p>This step does not use dSFMT internal state and independent
      from MEXPs except file names of the pre-calculated polynomials.
    </p>

    <h3><a id="execution">
	Step 2: Changing internal state of dSFMT to jumped state.</a></h3>

    <p>This step depends on MEXPs of dSFMT, and the
      polynomial file dSFMT should be the same as one used for the jump
      polynomial calculation.
    </p>
    <p>The function dSFMT_jump written in C language does this step.
      For our convenience, we used C structure for dSFMT internal state,
      and almost of all functions provided in dSFMT ver. 2.2 were
      re-written to use dSFMT structures.
    </p>

    <h2><a id="compile">Install, Compile and Test</a></h2>
    <p>Test program needs source programs of SFMT ver. 2.2 to be compiled.
    </p>

    <ol>
      <li>Install <a href="http://shoup.net/ntl/">NTL</a>
	if not installed. </li>
      <li>Expand archive file</li>
      <li>Copy <b>jump</b> directory in dSFMTJump-src-xxxx to
        the directory of dSFMT.</li>
<pre>
SFMT-src-2.2
   +---html
   +---jump
</pre>
      <li>Change directory to copied jump directory</li>
      <li>If you specify gmp or gf2x when you installed NTL,
	you need to uncomment one of below lines in Makefile.
      </li>
<pre>
#LIBGF2X = -lgf2x
#LIBGMP = -lgmp
</pre>
      <li>make</li>
    <blockquote>
<pre>
make all
make check
</pre>
    </blockquote>
      <li>Check if OK is showed and no NG</li>
    </ol>

    <p>test-jump-MXXX files made by above can invoke with '-s'
      argument like this:
    </p>
    <blockquote>
<pre>
$ ./test-jump-M19937 -s
mexp 19937 jump 10^04 steps  calc_jump: 0.707ms
mexp 19937 jump 10^04 steps dSFMT_jump: 0.166ms
mexp 19937 jump 10^06 steps  calc_jump: 3.527ms
mexp 19937 jump 10^06 steps dSFMT_jump: 3.657ms
mexp 19937 jump 10^08 steps  calc_jump: 6.310ms
mexp 19937 jump 10^08 steps dSFMT_jump: 3.628ms
mexp 19937 jump 10^10 steps  calc_jump: 9.221ms
mexp 19937 jump 10^10 steps dSFMT_jump: 3.579ms
mexp 19937 jump 10^12 steps  calc_jump:12.175ms
mexp 19937 jump 10^12 steps dSFMT_jump: 3.638ms
mexp 19937 jump 10^14 steps  calc_jump:15.176ms
mexp 19937 jump 10^14 steps dSFMT_jump: 3.630ms
mexp 19937 jump 10^16 steps  calc_jump:18.064ms
mexp 19937 jump 10^16 steps dSFMT_jump: 3.626ms
mexp 19937 jump 10^18 steps  calc_jump:20.959ms
mexp 19937 jump 10^18 steps dSFMT_jump: 3.606ms
mexp 19937 jump 10^20 steps  calc_jump:23.884ms
mexp 19937 jump 10^20 steps dSFMT_jump: 3.600ms
mexp 19937 jump 10^22 steps  calc_jump:26.920ms
mexp 19937 jump 10^22 steps dSFMT_jump: 3.592ms
</pre>
    </blockquote>

    <h2><a id="sample">Samples of Parallel generation</a></h2>
    <p>
      <a href="sample1.c">sample1.c</a> file included in the
      archive shows generation of
      5 distinct sub-sequences using 10<sup>20</sup> steps jump.
      As far as the length of each sub-sequence is smaller than
      10<sup>20</sup> the sub-sequences are not overlapping.
    </p>
    <p>
      Getting distinct sub sequences is an important purpose of
      jump function, however jump function is also available to get
      a sub-sequence using parallel computing.
      <br/>
      Here is a sample of generating a sequence using 5 dSFMT instances.
      This sample is included in the archive.
      <a href="sample2.c">sample2.c</a>
    </p>

    <h2><a id="license">License</a></h2>
    <p>
      sSFMT-jump, as well as sSFMT, can be used freely for any purpose,
      including commercial use. <br/>
      See <a href="LICENSE.txt">LICENSE.txt</a> for detail.
    </p>
  </body>
</html>
